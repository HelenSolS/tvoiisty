# Планы: fallback, монетизация, панель управления

Заложено в продукт, доработать когда дойдём.

---

## Переключение на запасную модель

- **Сейчас:** В панели настроек включено/выключено «При ошибке переключаться на запасную модель». **По умолчанию выключено** — включаем осознанно. Выключено → процесс заканчивается после первого запроса (даже с ошибкой). Включено → при ошибке KIE идёт запрос в Fal.
- **Позже:** Явно описать поведение при включённом fallback (в UI, в справке): что пользователь видит, что считается «ошибкой» и когда срабатывает запасная модель.

---

## Двойной запрос — двойные токены (монетизация)

- При срабатывании fallback выполняются **два** запроса (основная модель + запасная).
- **План:** при двойном запросе списывать/учитывать **двойные токены** (монетизация). Реализовать при вводе биллинга/учёта токенов.

---

---

## Что ещё добавить в панель управления (кандидаты)

- **Упрощённый режим (продакшн):** один переключатель — скрыть выбор моделей и ссылку на Лабораторию; везде только модели по умолчанию. Для продакшна без «лишнего» для пользователя.
- **Показывать Лабораторию:** отдельно включать/выключать пункт «Лаборатория — выбор моделей» в Настройках (включено в dev, выключено в проде).
- **Таймаут примерки (сек):** максимальное время ожидания ответа (сейчас зашито в коде/env). При превышении — своё сообщение пользователю.
- **Тексты ошибок:** кастомизация сообщений при таймауте, при ошибке сервера, «попробуйте другую модель» — для белой метки или точечных правок без деплоя.
- **Тема по умолчанию:** какая тема (turquoise/lavender/peach) у новых пользователей (сейчас в коде).
- **Лимит примерок:** число примерок в день на пользователя (на будущее, для биллинга/лимитов). Поле в панели, логику списания/проверки — позже.
- **Уведомления при сбоях:** URL вебхука (или вкл/выкл) для алертов при падении промпта/генерации (сейчас ADMIN_WEBHOOK_URL в env). В панели — только если вынесем настройку из env.

Приоритет по необходимости; часть имеет смысл после переноса настроек с localStorage на бэкенд.

---

*Напомнить команде/архитектору при переходе к биллингу и к формальному описанию поведения fallback.*
